\section{training}
\subsection{preferences prediction and feedback}
\begin{gather}
    \hat{r}(u,i)=~ \frac{1}{|T(u)|}\sum_{x \in T(u)}\frac{\Pi_{y \in T(i)} \omega(u,x,y)s(x,y)}{\Pi_{y \in T(i)}|\omega(u,x,y)|} \\
    \epsilon(u,i) =~ r(u,i) - \hat{r}(u,i) \\
    s(x,y)=~ s(x,y)+\lambda^{S}
    \eta \left(\epsilon(u,i)
    \Big(\frac{s(x,y)}{||S||_{2}}
    +\frac{\bar{s}(x)+\bar{s}(y)}{2}
    \Big) \right) \\
    \eta(x)=~ \begin{cases}
    x \geq 0,  2^{-1}x \\
    \text{otherwise},  2x
    \end{cases} \\
    \omega(u,x,y)=~ \omega(u,x,y)
    \frac{r(u,i)+\lambda^{\Omega} s(x,y)}
    {\hat{r}(u,i)+\gamma^{\Omega}\mathbb{W}(u,i)} \\
    \mathbb{W}(u,i)=~ \sum_{x\in NT(u)}\sum_{y \in T(i)} |\omega(u,x,y)| \\
    s(x,y)=~ s(x,y)\frac
    {r(u,i)+\lambda^{\Omega}\omega(u,x,y)}
    {\hat{r}(u,i) +\gamma^{\Omega}\mathbb{S}(u,i)} \\
    \mathbb{S}(u,i)=~ \sum_{NT(u)}\sum_{y \in T(i)} |s(x,y)|
\end{gather}

\subsection{objective functions}
\begin{gather}
    \mathcal{F}(\mathbb{X}(a), S, \Omega)=~ \frac{|\mathbb{X}(a)|}{|U|^{2} |I|} \sum_{u \in U}\big( \frac{1}{|T(u)||T|} \sum_{x \in T(u)} \sum_{y \in T} \left( w(u,x,y)s(x,y) \right)^{2} \big)^{0.5} \\
    \mathcal{L}^{S}(\mathbb{X}(a), S, \Omega) =~ \min \text{RMSE}^{S}(\mathbb{X}(a), S, \Omega) + \mathcal{F}(\mathbb{X}(a), S, \Omega) \\
    \mathcal{L}^{\Omega}(\mathbb{X}(a), S, \Omega) =~ \min \text{RMSE}^{\Omega}(\mathbb{X}(a), S, \Omega) + \mathcal{F}(\mathbb{X}(a), S, \Omega) \\
    \mathcal{L}(\mathbb{X}(a), S, \Omega) 
        =~ \frac{2 \mathcal{L}^{S}(\mathbb{X}(a), S, \Omega) \mathcal{L}^{\Omega}(\mathbb{X}(a), S, \Omega)}
        {\mathcal{L}^{S}(\mathbb{X}(a), S, \Omega) + \mathcal{L}^{\Omega}(\mathbb{X}(a), S, \Omega)} \\
    \arg_{S', \Omega'}~ \min \mathcal{L}(\mathbb{X}(a), S, \Omega) \label{eq:obj_func}
\end{gather}